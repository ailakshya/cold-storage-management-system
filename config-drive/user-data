#cloud-config
autoinstall:
  version: 1
  identity:
    hostname: cold-storage-server
    username: admin
    password: "$6$9y8PphWKqaODymVq$kMBkaCyXSWLvtF81KDMcbcTfSUTeLiJa.ysOloTCbdcBBoazMVi9ORqJQXI0DDt4pSv4OUqwjfZdry6A9Tu4T1" # Password: "Lak992723/"
  ssh:
    install-server: true
    allow-pw: true
  storage:
    config:
      # Disk 1
      - type: disk
        id: disk-primary
        match:
          path: /dev/sda
      
      # Disk 2
      - type: disk
        id: disk-secondary
        match:
          path: /dev/sdb

      # Partition Disk 1 (Boot + Root)
      - type: partition
        id: boot-part-a
        device: disk-primary
        size: 1G
        flag: boot
        grub_device: true
      - type: partition
        id: root-part-a
        device: disk-primary
        size: -1

      # Partition Disk 2 (Boot + Root)
      - type: partition
        id: boot-part-b
        device: disk-secondary
        size: 1G
        flag: boot
        grub_device: true
      - type: partition
        id: root-part-b
        device: disk-secondary
        size: -1

      # RAID 1
      - type: raid
        id: md0
        name: md0
        raidlevel: 1
        devices:
          - root-part-a
          - root-part-b
      
      # Format
      - type: format
        id: format-root
        fstype: ext4
        volume: md0

      # Mount
      - type: mount
        id: mount-root
        device: format-root
        path: /
